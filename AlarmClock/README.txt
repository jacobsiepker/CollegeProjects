Please pardon the blatent overuse of global variables, I have since learned.
